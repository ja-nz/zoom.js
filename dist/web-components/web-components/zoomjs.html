<zoom-js>
    <template id="zoomjs">
      <style>
img[data-action="zoom"] {
  cursor: pointer;
  cursor: zoom-in;
}
.zoom-img,
.zoom-img-wrap {
  position: relative;
  z-index: 666;
  transition: all 300ms;
}
img.zoom-img {
  cursor: pointer;
  cursor: zoom-out;
}
.zoom-overlay {
  z-index: 420;
  background: #fff;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity 300ms;
}
.zoom-overlay-open .zoom-overlay {
  opacity: 1;
}
.zoom-overlay-open,
.zoom-overlay-transitioning {
  cursor: default;
}
      </style>


    <slot>Drop me an image</slot>
  </template>


    <script>
        class ZoomJS extends HTMLElement {

            constructor() {
                super();
                this.offset = 80;
                this.current = null;
                this.attachShadow({
                    mode: 'open'
                });
                const template = this.querySelector('template#zoomjs');
                this.shadowRoot.appendChid(template.content);
            }

            connectedCallback() {
                if (this.childElementCount > 0) this.firstElementChild.addEventListener("click", this._startPreparation);
            }

            _startPreparation(e) {

                // Guards
                if (document.body.classList.contains("zoom-overlay-open")) {
                    return;
                }

                if (e.metaKey || e.ctrlKey) {
                    window.open((e.target.getAttribute("data-original") || e.target.src), "_blank");
                    return;
                }

                if (e.target.width >= document.documentElement.clientWidth - this.offset) {
                    return;
                }

                // var closeCurrent = force => {
                //     if (this.current == null) {
                //         return;
                //     }
                //     if (force) {
                //         this.current.dispose();
                //     } else {
                //         this.current.close();
                //     }
                //     removeCloseListeners();
                //     current = null;
                // };

                // // PrepCode
                // closeCurrent(true);

                // current = new ZoomImage(e.target, offset);
                // current.zoom();

                // addCloseListeners();


            }



        }

        customElements.define('zoom-js', ZoomJS);
    </script>
